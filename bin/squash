#!/usr/bin/env ruby

if ARGV.size != 2 || ARGV[0] != 'create'
  puts "Create a new empty application with: squash create <application_name>"
  exit
end

app = ARGV[1]
template_dir = File.expand_path(File.dirname(__FILE__)) + "/../template"

ENV['BUNDLE_GEMFILE'] = "./#{app}/Gemfile"

require 'rubygems'
require 'bundler/setup'

require 'fileutils'
FileUtils.mkdir app
FileUtils.cp_r "#{template_dir}/.", app
puts "Created Squash application: #{app}"

require 'bundler'
#Bundler.install
Bundler::Installer.install(app, Bundler::Definition.build("#{app}/Gemfile", "Gemfile.lock", true))
